{% extends "base.html" %}
{% block content %}

<h1>Reportes y Estad铆sticas</h1>
<p>M贸dulo de consulta general de informaci贸n de Recursos Humanos y Finanzas.</p>

<!-- ====== MEN DE DESCARGAS ====== -->
<div style="display:flex; gap:10px; flex-wrap:wrap; margin: 15px 0;">
    <a href="{{ url_for('reportes.exportar_csv', tipo='nomina') }}" class="btn-primary">CSV N贸mina</a>
    <a href="{{ url_for('reportes.exportar_csv', tipo='ausencias') }}" class="btn-primary">CSV Ausencias</a>
    <a href="{{ url_for('reportes.exportar_csv', tipo='evaluaciones') }}" class="btn-primary">CSV Evaluaciones</a>
    <a href="{{ url_for('reportes.exportar_csv', tipo='capacitaciones') }}" class="btn-primary">CSV Capacitaciones</a>
    <a href="{{ url_for('reportes.exportar_csv', tipo='proyectos') }}" class="btn-primary">CSV Proyectos</a>
    <a href="{{ url_for('reportes.exportar_csv', tipo='presupuestos') }}" class="btn-primary">CSV Presupuestos</a>
    <a href="{{ url_for('reportes.exportar_todo_csv') }}" class="btn-secondary"> Descargar Todo</a>
</div>

<hr>

<!-- ===================== -->
<!-- 1) RESUMEN DE NMINA -->
<!-- ===================== -->
<h2>Resumen de N贸mina</h2>
<table>
    <thead>
        <tr>
            <th>ID N贸mina</th>
            <th>Empleado</th>
            <th>Salario base</th>
            <th>Deducciones</th>
            <th>Percepciones</th>
            <th>Total a pagar</th>
            <th>Periodo inicio</th>
            <th>Periodo fin</th>
        </tr>
    </thead>
    <tbody>
        {% for r in rep_nomina %}
        <tr>
            <td>{{ r.id_nomina }}</td>
            <td>{{ r.nombre_completo }}</td>
            <td>{{ r.salario_base | currency }}</td>
            <td>{{ r.deducciones | currency }}</td>
            <td>{{ r.percepciones | currency }}</td>
            <td>{{ r.total_pagar | currency }}</td>
            <td>{{ r.fecha_inicio }}</td>
            <td>{{ r.fecha_fin }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<hr>

<h2>Ausencias del Personal</h2>
<table>
    <thead>
        <tr>
            <th>Empleado</th>
            <th>Tipo</th>
            <th>Fecha inicio</th>
            <th>Fecha fin</th>
            <th>Motivo</th>
        </tr>
    </thead>
    <tbody>
        {% for a in rep_ausencias %}
        <tr>
            <td>{{ a.nombre_completo }}</td>
            <td>{{ a.tipo }}</td>
            <td>{{ a.fecha_inicio }}</td>
            <td>{{ a.fecha_fin }}</td>
            <td>{{ a.motivo }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<hr>

<h2>Evaluaciones de Desempe帽o</h2>
<table>
    <thead>
        <tr>
            <th>Empleado</th>
            <th>Fecha evaluaci贸n</th>
            <th>Tipo</th>
            <th>Resultado</th>
            <th>Observaciones</th>
        </tr>
    </thead>
    <tbody>
        {% for e in rep_evaluaciones %}
        <tr>
            <td>{{ e.nombre_completo }}</td>
            <td>{{ e.fecha_evaluacion }}</td>
            <td>{{ e.tipo }}</td>
            <td>{{ e.resultado }}</td>
            <td>{{ e.observaciones }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<hr>

<h2>Capacitaciones por Empleado</h2>
<table>
    <thead>
        <tr>
            <th>Empleado</th>
            <th>Capacitaci贸n</th>
            <th>Proveedor</th>
            <th>Inicio</th>
            <th>Fin</th>
            <th>Resultado</th>
            <th>Comentarios</th>
        </tr>
    </thead>
    <tbody>
        {% for c in rep_capacitaciones %}
        <tr>
            <td>{{ c.nombre_completo }}</td>
            <td>{{ c.capacitacion }}</td>
            <td>{{ c.proveedor }}</td>
            <td>{{ c.fecha_inicio }}</td>
            <td>{{ c.fecha_fin }}</td>
            <td>{{ c.resultado }}</td>
            <td>{{ c.comentarios }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<hr>

<h2>Participaci贸n en Proyectos</h2>
<table>
    <thead>
        <tr>
            <th>Empleado</th>
            <th>Proyecto</th>
            <th>Horas asignadas</th>
            <th>Fecha asignaci贸n</th>
            <th>Fecha entrega</th>
        </tr>
    </thead>
    <tbody>
        {% for p in rep_proyectos %}
        <tr>
            <td>{{ p.nombre_completo }}</td>
            <td>{{ p.proyecto }}</td>
            <td>{{ p.horas_asignadas }}</td>
            <td>{{ p.fecha_asignacion }}</td>
            <td>{{ p.fecha_entrega }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<hr>

<h2>Presupuestos por Departamento</h2>
<table>
    <thead>
        <tr>
            <th>Departamento</th>
            <th>Periodo</th>
            <th>Monto asignado</th>
            <th>Monto utilizado</th>
            <th>Restante</th>
        </tr>
    </thead>
    <tbody>
        {% for p in rep_presupuestos %}
        <tr>
            <td>{{ p.departamento }}</td>
            <td>{{ p.periodo }}</td>
            <td>{{ p.monto_asignado | currency }}</td>
            <td>{{ p.monto_utilizado | currency }}</td>
            <td>{{ p.restante | currency }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

{% endblock %}
