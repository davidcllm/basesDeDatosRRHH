{% extends "base.html" %}
{% block content %}

<h1 class="titulo-vista">Reportes y Estadísticas</h1>

<!-- DESCARGA COMPLETA -->
<div style="margin-bottom:20px;">
    <a href="/reportes/zip" class="btn-primary">
        Descargar todos los reportes (ZIP)
    </a>
</div>

<!-- ================================================================ -->
<!-- 1️⃣ RESUMEN DE NÓMINA -->
<!-- ================================================================ -->
<h2 class="subtitulo">Resumen de Nómina</h2>

<a href="/reportes/csv/nomina" class="btn-secondary" style="margin-bottom:10px;display:inline-block;">
    Descargar CSV
</a>

<table class="tabla">
    <thead>
        <tr>
            <th>ID Nómina</th>
            <th>Empleado</th>
            <th>Salario Base</th>
            <th>Deducciones</th>
            <th>Percepciones</th>
            <th>Total a Pagar</th>
            <th>Inicio</th>
            <th>Fin</th>
        </tr>
    </thead>
    <tbody>
        {% for r in rep_nomina %}
        <tr>
            <td>{{ r.id_nomina }}</td>
            <td>{{ r.nombre_completo }}</td>
            <td>${{ r.salario_base }}</td>
            <td>${{ r.deducciones }}</td>
            <td>${{ r.percepciones }}</td>
            <td>${{ r.total_pagar }}</td>
            <td>{{ r.fecha_inicio }}</td>
            <td>{{ r.fecha_fin }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<br>

<!-- ================================================================ -->
<!-- 2️⃣ AUSENCIAS DEL PERSONAL -->
<!-- ================================================================ -->
<h2 class="subtitulo">Ausencias del Personal</h2>

<a href="/reportes/csv/ausencias" class="btn-secondary" style="margin-bottom:10px;display:inline-block;">
    Descargar CSV
</a>

<table class="tabla">
    <thead>
        <tr>
            <th>Empleado</th>
            <th>Tipo</th>
            <th>Inicio</th>
            <th>Fin</th>
            <th>Motivo</th>
        </tr>
    </thead>
    <tbody>
        {% for a in rep_ausencias %}
        <tr>
            <td>{{ a.nombre_completo }}</td>
            <td>{{ a.tipo }}</td>
            <td>{{ a.fecha_inicio }}</td>
            <td>{{ a.fecha_fin }}</td>
            <td>{{ a.motivo }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<br>

<!-- ================================================================ -->
<!-- 3️⃣ EVALUACIONES -->
<!-- ================================================================ -->
<h2 class="subtitulo">Evaluaciones de Desempeño</h2>

<a href="/reportes/csv/evaluaciones" class="btn-secondary" style="margin-bottom:10px;display:inline-block;">
    Descargar CSV
</a>

<table class="tabla">
    <thead>
        <tr>
            <th>Empleado</th>
            <th>Fecha Evaluación</th>
            <th>Tipo</th>
            <th>Resultado</th>
            <th>Observaciones</th>
        </tr>
    </thead>
    <tbody>
        {% for ev in rep_evaluaciones %}
        <tr>
            <td>{{ ev.nombre_completo }}</td>
            <td>{{ ev.fecha_evaluacion }}</td>
            <td>{{ ev.tipo }}</td>
            <td>{{ ev.resultado }}</td>
            <td>{{ ev.observaciones }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<br>

<!-- ================================================================ -->
<!-- 4️⃣ CAPACITACIONES -->
<!-- ================================================================ -->
<h2 class="subtitulo">Capacitaciones por Empleado</h2>

<a href="/reportes/csv/capacitaciones" class="btn-secondary" style="margin-bottom:10px;display:inline-block;">
    Descargar CSV
</a>

<table class="tabla">
    <thead>
        <tr>
            <th>Empleado</th>
            <th>Capacitación</th>
            <th>Proveedor</th>
            <th>Inicio</th>
            <th>Fin</th>
            <th>Resultado</th>
            <th>Comentarios</th>
        </tr>
    </thead>
    <tbody>
        {% for c in rep_capacitaciones %}
        <tr>
            <td>{{ c.nombre_completo }}</td>
            <td>{{ c.capacitacion }}</td>
            <td>{{ c.proveedor }}</td>
            <td>{{ c.fecha_inicio }}</td>
            <td>{{ c.fecha_fin }}</td>
            <td>{{ c.resultado }}</td>
            <td>{{ c.comentarios }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<br>

<!-- ================================================================ -->
<!-- 5️⃣ PROYECTOS -->
<!-- ================================================================ -->
<h2 class="subtitulo">Participación en Proyectos</h2>

<a href="/reportes/csv/proyectos" class="btn-secondary" style="margin-bottom:10px;display:inline-block;">
    Descargar CSV
</a>

<table class="tabla">
    <thead>
        <tr>
            <th>Empleado</th>
            <th>Proyecto</th>
            <th>Horas Asignadas</th>
            <th>Fecha Asignación</th>
            <th>Fecha Entrega</th>
        </tr>
    </thead>
    <tbody>
        {% for p in rep_proyectos %}
        <tr>
            <td>{{ p.nombre_completo }}</td>
            <td>{{ p.proyecto }}</td>
            <td>{{ p.horas_asignadas }}</td>
            <td>{{ p.fecha_asignacion }}</td>
            <td>{{ p.fecha_entrega }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<br>

<!-- ================================================================ -->
<!-- 6️⃣ PRESUPUESTOS -->
<!-- ================================================================ -->
<h2 class="subtitulo">Presupuestos por Departamento</h2>

<a href="/reportes/csv/presupuestos" class="btn-secondary" style="margin-bottom:10px;display:inline-block;">
    Descargar CSV
</a>

<table class="tabla">
    <thead>
        <tr>
            <th>Departamento</th>
            <th>Periodo</th>
            <th>Asignado</th>
            <th>Utilizado</th>
            <th>Restante</th>
        </tr>
    </thead>
    <tbody>
        {% for pr in rep_presupuestos %}
        <tr>
            <td>{{ pr.departamento }}</td>
            <td>{{ pr.periodo }}</td>
            <td>${{ pr.monto_asignado }}</td>
            <td>${{ pr.monto_utilizado }}</td>
            <td>${{ pr.restante }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

{% endblock %}
